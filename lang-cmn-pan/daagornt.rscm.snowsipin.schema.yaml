# Rime schema
# encoding: utf-8

schema:
  name: '大狗冰雪四拼'
  schema_id: daagornt.rscm.snowsipin
  author:
    - '键盘布局 谭淞宸'
    - '方案集成 丢狼'
  description: |
    冰雪四拼（无顶字）输入方案
  version: '2.25.270.1904'
  icon: daagornt.icon.imecn.ico
  ascii_icon: daagornt.icon.ascii.ico

switches:
  __include: daagornt.lib.shared.yaml:/zh_cn_simp/switches

engine:
  __include: daagornt.lib.shared.yaml:/engines

speller:
  alphabet: bpmfdtnlgkhjqxzcsrwyvaeiou
  initials: bpmfdtnlgkhjqxzcsrwyv
  delimiter: " ';"
  auto_select: false
  use_space: false
  algebra:
    __patch:
      - daagornt.lib.dict-cmn-pan.yaml:/algebra/normalizer
      - daagornt.lib.dict-cmn-pan.yaml:/algebra/encoder
      - /rule_convert/layout

translator:
  __patch:
    - daagornt.lib.shared.yaml:/translator
    - daagornt.lib.dict-cmn-pan.yaml:/translator
  prism: daagornt.snowsipin

history:
  __include: daagornt.lib.shared.yaml:/history

custom_phrase:
  __include: daagornt.lib.shared.yaml:/custom_phrase

ascii_char:
  __include: daagornt.lib.shared.yaml:/ascii_char

ascii_phrase:
  __include: daagornt.lib.shared.yaml:/ascii_phrase

quick_phrase:
  __include: daagornt.lib.shared.yaml:/quick_phrase

extchar:
  __include: daagornt.lib.shared.yaml:/extchar?

grammar:
  __include: daagornt.lib.dict-cmn-pan.yaml:/grammar

punctuator:
  __include: daagornt.lib.shared.yaml:/punctuator

key_binder:
  __include: daagornt.lib.shared.yaml:/key_binder

recognizer:
  __include: daagornt.lib.shared.yaml:/recognizer

menu:
  __include: daagornt.lib.shared.yaml:/menu

style:
  __include: daagornt.lib.shared.yaml:/zh_cn_simp/style?

editor:
  __include: daagornt.lib.shared.yaml:/editor

ascii_composer:
  __include: daagornt.lib.shared.yaml:/ascii_composer

zh_cn_simp:
  __include: daagornt.lib.dict-cmn-pan.yaml:/zh_cn_simp

zh_cn_trad:
  __include: daagornt.lib.dict-cmn-pan.yaml:/zh_cn_trad

zh_tw:
  __include: daagornt.lib.dict-cmn-pan.yaml:/zh_tw

zh_hk:
  __include: daagornt.lib.dict-cmn-pan.yaml:/zh_hk

rule_convert:
  layout:
    __append:
      # Partial Hanyu Pinyin Flattening
      - 'xform <_h> <re>'
      - 'xform <ng> <n>'
      - 'xform <gn> <g>'
      - 'xform <v> <w>'
      - 'xform <5> <0>'
      # Sibilant Compatibility
      - 'derive <ts><([iy])> <ts6><$1>'
      - 'derive <tsh><([iy])> <ts6h><$1>'
      - 'derive <s><([iy])> <s6><$1>'
      - 'derive <k><([iy])> <ts6><$1>'
      - 'derive <kh><([iy])> <ts6h><$1>'
      - 'derive <[xh]><([iy])> <s6><$1>'
      # Schemata key convert
      - 'xform ^(<[aoe]) r$1'
      - 'xform ^(<re) r$1'
      - 'xform ^(<_) r$1'
      - 'xform <j> f<i>'
      - 'xform <w> s<u>'
      - 'xform <4y> k<y>'
      - 'xform <i><i> <i>'
      - 'xform <u><u> <u>'
      - 'xform <y><y> <y>'
      - 'xform <p> b'
      - 'xform <ph> p'
      - 'xform <m> m'
      - 'xform <f> f'
      - 'xform <t> d'
      - 'xform <th> t'
      - 'xform <n> n'
      - 'xform <l> l'
      - 'xform <k> g'
      - 'xform <kh> k'
      - 'xform (<x>|<h>) h'
      - 'xform <ts6> j'
      - 'xform <ts6h> q'
      - 'xform <s6> x'
      - 'xform <tis> w'
      - 'xform <tish> y'
      - 'xform <is> v'
      - 'xform <zi> r'
      - 'xform <ts> z'
      - 'xform <tsh> c'
      - 'xform <s> s'
      - 'xform ^(.)(<i><au>)(<\d>)$ $1uu$3'
      - 'xform ^(.)(<i><ou>|<ou>)(<\d>)$ $1ou$3'
      - 'xform ^(.)(<i><ai>|<u><ei>)(<\d>)$ $1ui$3'
      - 'xform ^(.)(<i><ei>|<u><ai>)(<\d>)$ $1ii$3'
      - 'xform ^(.)(<i><an>|<u><en>)(<\d>)$ $1uo$3'
      - 'xform ^(.)(<i><en>|<u><an>)(<\d>)$ $1io$3'
      - 'xform ^(.)(<i><ang>|<u><reng>)(<\d>)$ $1ue$3'
      - 'xform ^(.)(<i><reng>|<u><ang>)(<\d>)$ $1ie$3'
      - 'xform ^(.)(<i><ong>|<ong>)(<\d>)$ $1oe$3'
      - 'xform ^(.)(<y><an>)(<\d>)$ $1oo$3'
      - 'xform ^(.)(<y><en>|<an>)(<\d>)$ $1ao$3'
      - 'xform ^(.)(<y><o>|<au>)(<\d>)$ $1au$3'
      - 'xform ^(.)(<i><e3>|<re>|<e3>)(<\d>)$ $1e$3'
      - 'xform ^(.)(<i><o>|<u><o>|<y><e3>|<o>)(<\d>)$ $1o$3'
      - 'xform ^(.)(<i><a>|<u>)(<\d>)$ $1u$3'
      - 'xform ^(.)(<u><a>|<_[iw]>|<i>|<ar>)(<\d>)$ $1i$3'
      - 'xform ^(.)(<y>|<a>)(<\d>)$ $1a$3'
      - 'xform ^(.)(<ai>)(<\d>)$ $1ai$3'
      - 'xform ^(.)(<ei>)(<\d>)$ $1ei$3'
      - 'xform ^(.)(<en>|<_n>)(<\d>)$ $1eo$3'
      - 'xform ^(.)(<ang>)(<\d>)$ $1ae$3'
      - 'xform ^(.)(<reng>|<_ng>)(<\d>)$ $1ee$3'
      - 'xform ^(.)(<_m>)(<\d>)$ $1ea$3'
      - 'xform <0> o'
      - 'xform <1> i'
      - 'xform <2> e'
      - 'xform <3> u'
      - 'xform <4> a'
      - 'abbrev ^(.).+$ $1'
      - 'abbrev ^(.)([aeiou]).+$ $1$2'
      - 'abbrev ^(.)([aeiou])([aeiou]).+$ $1$2$3'
